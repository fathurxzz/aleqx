@using SiteExtensions.Graphics
@using Vip
@using Vip.Models
@model Vip.Models.CatalogueViewModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="catalogue">
    @Html.Partial("_LayoutsFilter", Model.LayoutFilter)
        @if (Request.IsAuthenticated) {
    <div>
        @Html.ActionLink("Добавить раздел", "Create", "Category", new { Area = "Admin" }, new { @class = "adminLink" })
    </div>
    }

    @if (Model.Categories != null)
    {
        <div class="mainTitle">
        </div>
        <div class="categoriesContainer">
            @foreach (var item in Model.Categories)
            {
                <div class="category">
                    <div class="img-container">
                        <div class="sign">
                            @item.Title
                        </div>
                        @Html.Raw(Html.ActionLink("[IMAGE]", "Index", "Catalogue", new { category = item.Name }, null).ToString().Replace("[IMAGE]", Html.CachedImage("~/Content/Images/", item.ImageSource, SiteSettings.GetThumbnail("catalogueThumbnail"), ScaleMode.Corp)))
                    </div>
                </div>
                
            }
            <div class="clear">
            </div>
        </div>
        
        
    }
    else
    {
        @Html.Partial("_AttributesFilter", Model.AttributesFilter)
       if (Request.IsAuthenticated)
       {
            <div>
                @Html.ActionLink("Добавить изображение", "Create", "Product", new { Area = "Admin", id = Model.Category.Id }, new { @class = "adminLink" })
            </div>
       }
        <div class="productsContainer">
            @foreach (var item in Model.Products)
            {
                <div class="product">
                    @if (Request.IsAuthenticated)
                    {
                        <div>
                            @Html.ActionLink("редактировать", "Edit", "Product", new { area = "Admin", id = item.Id }, new { @class = "adminLink" })
                            @Html.ActionLink("удалить", "Delete", "Product", new { area = "Admin", id = item.Id }, new { @class = "adminLink", onclick = "return confirm('Вы действительно хотите удалить изображение?')" })
                        </div>
                    }
                    <div class="img-container">
                        <a rel="@Html.Raw("group1")" href="../../Content/Images/@item.ImageSource" class="fancyImage"  >
                            @Html.Raw(Html.CachedImage("~/Content/Images/", item.ImageSource, SiteSettings.GetThumbnail("catalogueThumbnail"), ScaleMode.Corp))
                        </a>
                    </div>
                    <div class="sign">
                        <span class="title">
                            @item.Title @item.Brand.Title
                        </span>
                    </div>
                </div>
            }
            <div class="clear">
            </div>
            @Html.Partial("_Paging")
            <div class="clear">
            </div>
        </div>
    }
    
     @if (!string.IsNullOrEmpty(Model.Category.Description) || !string.IsNullOrEmpty(Model.Category.DescriptionTitle))
    {
        @Html.Partial("AboutModel", new AboutModel { Title = Model.Category.DescriptionTitle, Text = Model.Category.Description })
    }
    @if (Request.IsAuthenticated)
    {
        <div style="text-align: center; margin-top: 100px;">
        @Html.ActionLink("Редактировать страницу", "Edit", "Category", new { area = "Admin", id = Model.Category.Id }, new { @class = "adminLink" })
        </div>
    }

</div>
