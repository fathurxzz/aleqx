@using Filimonov
@using SiteExtensions.Graphics
@model Filimonov.Models.Project
<div class="container">
    <div class="page">
        <div class="menu menuItem projectMenuItem">
            <a href="#" class="showLink">Проекты</a>
            @if (Request.IsAuthenticated)
            {
                <div>
                    @Html.ActionLink("Редактировать", "Edit", "Content", new { area = "Admin", id = Model.Id }, new { @class = "adminLink" })
                </div>
            }
        </div>
    </div>
    <div class="frame projectFrame">
        <div class="top">
        </div>
        <div class="middle projects">
            <div class="hide">
                <div class="hideLink">
                </div>
            </div>
            <div class="titleContainer">
                <div class="inner">
                    <div class="titleContainerLeft">
                        <div class="titleContainerRight">
                            <div class="title">
                                @Html.ActionLink("Проекты", "Projects", "Home", new { id = "" }, null) &laquo;
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="main-view-container">
                <div class="title">
                    @Model.Title
                </div>
                <div class="picture">
                    
                    @if (Model.ProjectImages.Count > 0)
                    {
                        <a href="#" id="pictureLink" class="fancy">
                        </a>    
                        <img src="" alt="" id="pictureContainer" />
                    }
                </div>
            </div>
            <div class="carusel-previews">
                @foreach (var image in Model.ProjectImages)
                {
                    <div class="preview" style="cursor: pointer" onclick="ProjectCatalogue.changeImage('@image.ImageSource') ">
                        @if (Request.IsAuthenticated)
                        {
                            <div style="position: absolute">
                                @Html.ActionLink("Удалить", "DeleteImage","Project",new{area="Admin",id=image.Id},new{@class="adminLink",onclick="return confirm('Удалить изображение?')"})
                            </div>
                        }

                        @Html.Raw(Html.CachedImage("~/Content/Images/", image.ImageSource, SiteSettings.GetThumbnail("caruselPreview")))    
                    </div>
                }
                <div class="clear"></div>
            </div>
            @if (Request.IsAuthenticated)
            {
                <div>
                    @Html.ActionLink("Редактировать", "Edit", "Project", new { area = "Admin", id = Model.Id }, new { @class = "adminLink" })
                    
                    @Html.ActionLink("Добавить изображение", "AddImageToProject", "Project", new { area = "Admin", id = Model.Id }, new { @class = "adminLink" })
                    
                    @Html.ActionLink("Удалить проект", "Delete", "Project", new { area = "Admin", id = Model.Id }, new { @class = "adminLink", onclick = "return confirm('Удалить проект?')" })
                </div>
            }
            <div class="description-title-line">
            </div>
            <div class="description-title">
                @(!string.IsNullOrEmpty(Model.DescriptionTitle) ? Model.DescriptionTitle : "О проекте")
            </div>
            <div class="description-title-line">
            </div>
            <div class="description-text">
                @Html.Raw(Model.Description)
            </div>
        </div>
        <div class="bottom">
        </div>
    </div>
</div>
<div class="page">
    <div class="menu" style="height: 50px;">
    </div>
</div>



<script type="text/javascript">
    ProjectCatalogue.setFirstImage();
</script>